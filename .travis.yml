language: python

notifications:
  email:
    # change is when the repo status goes from pass to fail or vice versa
    on_success: change
    on_failure: always

# whitelist
branches:
  only:
    - master
    - development

# blacklist
  except:
    - /^.*test.*$/


# Existing Python versions
python:
  - 2.7
  - 3.4
  - 3.5
  - 3.6
# Enable 3.7 without globally enabling sudo and dist: xenial for other build jobs
matrix:
  include:
    - python: 3.7
      dist: xenial
      sudo: true

# Django versions to test against
env:
  - DJANGO_VERSION=2.1.1 SECRET_KEY='sooper-s3cr3+-k3y' DEBUG='True'

before_install:
    - "export DISPLAY=:99.0"
    - "sh -e /etc/init.d/xvfb start"
    - sleep 3 # give xvfb some time to start

install:
  - pip install -r requirements.txt
  - pip install -q Django==$DJANGO_VERSION

addons:
  postgresql: "10.5"

services:
  - postgresql

before_script:
  - psql -c 'create database travis_ci_test;' -U postgres

script:
  - cd estmator_project
  - python manage.py test
